<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="/static/main.css">
    <link rel="stylesheet" href="/static/home_page.css">
    <!--Links to the external stylesheet so that the page uses the CSS from it-->
    <link href="https://fonts.googleapis.com/css2?family=Pattaya&family=Poppins:wght@400;500&display=swap"
          rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Play&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;1,400&display=swap" rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" type="text/css" href="static/font-awesome/css/font-awesome.min.css">
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">

    <title>CVP | Settings</title>
</head>
<body>
    <nav class="nav fixed profile-settings">
        <ul class="nav__list">
            <li class="nav__list-logo">
                <h1 id="logo"><a href="/profile_{{ token }}">CoVaPass</a></h1>
            </li>
        </ul>
    </nav>

<form action={{url_for('settings', token=token)}} method="POST" enctype="multipart/form-data">
    <div class="left-panel margin-for-nav">
        <h1 class="page-header">Profile Settings</h1>
    </div>

    <div class="right-panel margin-for-nav">

            <div class="container top-margin-med">

                <div class="input-field">
                    <img class="profile-pic settings-pic" src="{{ url_for('static', filename=pic) }}" alt="Your profile picture">
                    <div class="file-upload">
                        <input class="pic-upload-input" type="file" id="myPic" name="profile_pic">
                        <button class="pic-upload-button" type="button" title="Edit Photo">Edit Photo</button>
                        <span class="pic-upload-label"></span>
                        <img class="field-icon" src="{{url_for('static', filename='images/upload-icon.png')}}" alt="Profile Photo">
                    </div>
                </div>
                <div class="input-field">
                    <!--This div might seem unecessary but we can include an icon right beside the label element if we wish.-->
                    <div class="field-label">
                        <label class="text-label" for="first_name">Username:</label>
                    </div>

                    <!--Finally the text field for the user to enter data into.-->
                    <input class="text-field" type="text" id="user_name" name="user_name" placeholder="Username">
                </div>

                <div class="input-field">

                    <!--This div might seem unecessary but we can include an icon right beside the label element if we wish.-->
                    <div class="field-label">
                        <label class="text-label" for="email">Email:</label>
                    </div>

                    <!--Finally the text field for the user to enter data into.-->
                    <input class="text-field" type="text" id="email" name="email" placeholder="hello@cvp.org">
                </div>

                <div class="input-field">
                    <button class="inline-button smaller" name="back_button" value=True>Back</button>
                    <button class="inline-button smaller" name="profile_save" value=True type="submit">Save</button>
                </div>

                <div class="input-field top-margin-med">
                    <a id="changepass" class="change-pass" href="#">Change Password</a>
                </div>

            </div>
    </div>

    {% if (session['message']) %}
    <div class="alert-modal">
        <div class="modal-alert">
            <div class="modal-header"></div>
            <p class="modal-text">{{ session['message'] }}</p>
            <a id="alert-back" class="inline-button alerts" href="#">Got it!</a>
        </div>
    </div>
        <script>
            document.getElementById('alert-back').addEventListener('click',
                function(){
                    document.querySelector('.alert-modal').style.display = 'none';
            });
        </script>
    {% endif %}

    <div class="change-pass-modal">
        <div class="modal-content larger">
            <div class="modal-header"></div>

            <div class="input-field top-margin-small">

                <!--This div might seem unecessary but we can include an icon right beside the label element if we wish.-->
                <div class="field-label">
                    <label class="text-label" for="old_pass">Current Password:</label>
                </div>

                <!--Finally the text field for the user to enter data into.-->
                <input class="modal-text-field" type="password" id="old_pass" name="current_password" placeholder="Current Password">
            </div>

            <div class="input-field">
                <div class="field-note">
                    <p class="text-label-small">
                        - 8 characters minimum<br>
                        - 21 characters maximum <br>
                        - At least 1 uppercase character<br>
                        - At least 1 lowercase character <br>
                        - Must contains at least 1 <br>special character: @ $ ! % * # ? &
                    </p>
                </div>
            </div>

            <div class="input-field">

                <!--This div might seem unecessary but we can include an icon right beside the label element if we wish.-->
                <div class="field-label">
                    <label class="text-label" for="new_pass">New Password:</label>
                </div>

                <!--Finally the text field for the user to enter data into.-->
                <input class="modal-text-field" type="password" id="new_pass" name="new_password" placeholder="New Password">
            </div>

            <div class="input-field">

            <!--This div might seem unecessary but we can include an icon right beside the label element if we wish.-->
                <div class="field-label">
                    <label class="text-label" for="confirm_pass">Confirm New Password:</label>
                </div>

                    <!--Finally the text field for the user to enter data into.-->
                <input class="modal-text-field" type="password" id="confirm_pass" name="confirm_password" placeholder="New Password">
            </div>
            <div class="input-field">

                <a id="pass-back" class="inline-button smaller block-modal" href="#">Back</a>
                <button id="savechange" class="inline-button smaller block-modal" name="password_save_button" value=True type="submit">Save</button>
            </div>
        </div>
    </div>
    <div class="sign-out-modal">
        <div class="modal-content">
            <div class="modal-header"></div>
            <p class="modal-text">You're about to sign out!</p>
            <a id="sign-back" class="modal-anchor" name="sign-out-back-settings" value="sign-out-back-settings">Back</a>
            <button class="modal-button" name="sign_out_button" value=True type="submit">Sign Out</button>
        </div>
    </div>
</form>
<footer class="footer">
            <div class="inner_footer">
                <div class="footer-content">
                    <h2>Covid Vaccine Passport</h2>
                    <p>Web app that will bring convenience to everyone</p>
                </div>
                <div class="footer-content">
                    <h2>Company</h2>
                    <li><a href="#">Terms & Condition</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Project Protection</a></li>
                    <li><a href="#">FAQs</a></li>
                </div>
                <div class="footer-content">
                    <h2>About</h2>
                    <li><a href="#">Team</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Contact</a></li>
                </div>
                <div class="footer-content">
                    <h2>Help</h2>
                    <li><a href="#">Getting Started</a></li>
                    <li><a href="#">Feedback</a></li>
                    <li><a href="#">Network Status</a></li>
                    <li><a href="#">Support</a></li>
                    <li><a href="#">Other Services</a></li>
                </div>
                <div class="footer-content">
                    <h2>Newsletter</h2>
                    <form action="">
                        <div class="socials">
                            <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                            <li><a href="#"><i class="fa fa-google-plus"></i></a></li>
                            <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
                        </div>
                    </form>
                </div>
            </div>
            <hr>
            <p class="copyright">All Rights Reserved &copy;
                <script>document.write(new Date().getFullYear())</script>
                Covid Vaccine Passport
            </p>
        </footer>

<script>
    Array.prototype.forEach.call(document.querySelectorAll('.pic-upload-button'), function(button){
        const hiddenPicInput = button.parentElement.querySelector('.pic-upload-input');
        const picLabel = button.parentElement.querySelector('.pic-upload-label');
        const defaultPicLabelText = 'No File selected';

        picLabel.textContent = defaultPicLabelText;
        picLabel.title = defaultPicLabelText;
        <!--Utilizes an event listener to call the function that triggers the default input button-->
        button.addEventListener('click', function(){
            hiddenPicInput.click();
        });

        hiddenPicInput.addEventListener('change', function(){
            console.log(hiddenPicInput.files);
            const filenameList = Array.prototype.map.call(hiddenPicInput.files, function(pic) {
                return pic.name;
            });

            picLabel.textContent = filenameList.join(', ') || defaultPicLabelText;
            picLabel.title = picLabel.textContent;
        });
    });

    let input = document.getElementById("old_pass");
        // Execute a function when the user releases a key on the keyboard
        input.addEventListener("keydown", function (event) {
            // Number 13 is the "Enter" key on the keyboard
            if (event.keyCode === 13) {
                // Cancel the default action, if needed
                event.preventDefault();
                // Trigger the button element with a click
                document.getElementById("savechange").click();
            }
        });
        let input2 = document.getElementById("new_pass");
        // Execute a function when the user releases a key on the keyboard
        input2.addEventListener("keydown", function (event) {
            // Number 13 is the "Enter" key on the keyboard
            if (event.keyCode === 13) {
                // Cancel the default action, if needed
                event.preventDefault();
                // Trigger the button element with a click
                document.getElementById("savechange").click();
            }
        });
        let input3 = document.getElementById("confirm_pass");
        // Execute a function when the user releases a key on the keyboard
        input3.addEventListener("keydown", function (event) {
            // Number 13 is the "Enter" key on the keyboard
            if (event.keyCode === 13) {
                // Cancel the default action, if needed
                event.preventDefault();
                // Trigger the button element with a click
                document.getElementById("savechange").click();
            }
        });

    document.getElementById('changepass').addEventListener('click',
        function(){
        document.querySelector('.change-pass-modal').style.display = 'flex';
    });

    document.getElementById('pass-back').addEventListener('click',
        function(){
            document.querySelector('.change-pass-modal').style.display = 'none';
    });

</script>
</body>
</html>